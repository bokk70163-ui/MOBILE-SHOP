{% extends 'base.html' %}

{% block head %}
<style>
    body { background-color: white; }
    .product-container { max-width: 1100px; margin: 20px auto; padding: 20px; display: flex; gap: 40px; }
    
    /* Left: Image */
    .product-image { flex: 1; display: flex; justify-content: center; align-items: flex-start; }
    .product-image img { max-width: 100%; max-height: 450px; object-fit: contain; }

    /* Middle: Details */
    .product-details { flex: 1.5; }
    .product-title { font-size: 22px; font-weight: 500; color: #0F1111; line-height: 1.3; margin-bottom: 10px; }
    .product-rating { color: #ffa41c; font-size: 13px; margin-bottom: 10px; }
    .divider { height: 1px; background: #e7e7e7; margin: 10px 0; }
    .product-price { font-size: 24px; font-weight: 500; color: #0F1111; }
    .price-symbol { font-size: 14px; vertical-align: top; }
    .about-item h3 { font-size: 15px; font-weight: bold; margin-bottom: 8px; }
    .about-item p { font-size: 14px; color: #333; line-height: 1.5; }

    /* Right: Buy Box */
    .buy-box { flex: 0.8; border: 1px solid #d5d9d9; border-radius: 8px; padding: 15px; height: fit-content; background: white; }
    .stock-status { color: #007600; font-size: 17px; font-weight: 500; margin-bottom: 10px; }
    
    .btn { width: 100%; padding: 8px; border: none; border-radius: 20px; cursor: pointer; font-size: 13px; margin-bottom: 8px; text-align: center; box-shadow: 0 2px 5px rgba(213,217,217,.5); }
    .btn-cart { background-color: #ffd814; border: 1px solid #fcd200; }
    .btn-cart:hover { background-color: #f7ca00; }
    .btn-buy { background-color: #ffa41c; border: 1px solid #ff8f00; }
    .btn-buy:hover { background-color: #fa8900; }

    @media (max-width: 768px) { .product-container { flex-direction: column; } }
</style>
{% endblock %}

{% block content %}
<div class="product-container">
    <div class="product-image">
        <img src="{{ product.image }}" alt="{{ product.name }}">
    </div>

    <div class="product-details">
        <div class="product-title">{{ product.name }}</div>
        <div class="product-rating"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i> <span>(120 ratings)</span></div>
        <div class="divider"></div>
        <div class="product-price"><span class="price-symbol">$</span>{{ product.price }}</div>
        <div class="divider"></div>
        <div class="about-item">
            <h3>About this item</h3>
            <p>{{ product.description }}</p>
        </div>
    </div>

    <div class="buy-box">
        <div class="product-price" style="font-size: 18px; color: #B12704; margin-bottom: 5px;">${{ product.price }}</div>
        <div style="font-size: 13px; color: #565959; margin-bottom: 10px;">FREE delivery via Amazon Clone</div>
        <div class="stock-status">In Stock: {{ product.quantity }}</div>
        
        <button class="btn btn-cart" onclick="addToCart()">Add to Cart</button>
        <button class="btn btn-buy" onclick="addToCart(); window.location.href='/cart'">Buy Now</button>
        
        <div style="font-size: 12px; color: #565959; margin-top: 10px; display: flex; gap:5px;">
            <i class="fa-solid fa-lock"></i> Secure transaction
        </div>
    </div>
</div>

<script>
    function addToCart() {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const product = {
            id: "{{ product.id }}",
            name: "{{ product.name }}",
            price: {{ product.price }},
            image: "{{ product.image }}",
            qty: 1
        };
        
        const existing = cart.find(item => item.id === product.id);
        if (existing) { existing.qty += 1; } 
        else { cart.push(product); }
        
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCount();
        // Visual Feedback (Not browser alert)
        const btn = document.querySelector('.btn-cart');
        const origText = btn.innerText;
        btn.innerText = "Added! âœ“";
        setTimeout(() => btn.innerText = origText, 1500);
    }
</script>
{% endblock %}
